(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3957],{668:(e,t,r)=>{"use strict";r.d(t,{M:()=>o});let o="http://localhost:5200"},4553:(e,t,r)=>{"use strict";r.d(t,{b:()=>o});let o=()=>localStorage.getItem("usertoken")},5524:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var o=r(5155),a=r(6736),c=r(5695),s=r(2115),n=r(1867),i=r(4016),l=r(680),d=r(8964),h=r(902),u=r(9986),m=r(3464),p=r(4553),g=r(668);function x(){let{manage:e}=(0,c.useParams)(),t=(0,c.useRouter)(),[r,x]=(0,s.useState)({}),[j,y]=(0,s.useState)(!0),[f,b]=(0,s.useState)(null),[w,E]=(0,s.useState)(null),[v,N]=(0,s.useState)(!1),[A,C]=(0,s.useState)(!1),[T,_]=(0,s.useState)(""),[S,k]=(0,s.useState)(""),[P,M]=(0,s.useState)(!1),F=(0,p.b)();(0,s.useEffect)(()=>{let e=document.getElementsByClassName("modal-backdrop");for(;e.length>0;)e[0].parentNode.removeChild(e[0]);document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},[]),(0,s.useEffect)(()=>{let t=async()=>{y(!0);try{let t=await (0,a.oo)(e);t&&t.product&&x(t.product)}catch(e){_("Error loading product: ".concat(e.message)),console.log("server error ".concat(e.message))}finally{y(!1)}};e&&t()},[e]);let G=async()=>{if(!f){_("Please select a photo to upload");return}N(!0),_(""),k("");try{let r=new FormData;r.append("photo",f);let o=await m.A.put("".concat(g.M,"/admin/update_product_photo/").concat(e),r,{headers:{Authorization:"Bearer ".concat(F),"Content-Type":"multipart/form-data"}});if(o.data.msg)k("Product photo updated successfully!"),E(null),b(null),t.push("/admin/products/manage");else throw Error(o.data.msg||"Failed to update product photo")}catch(e){_(e.message||"An error occurred while updating the photo"),console.error("Update photo error:",e)}finally{N(!1)}},B=async()=>{C(!0),_("");try{let e=await m.A.delete("".concat(g.M,"/admin/delete_product/").concat(r._id),{headers:{Authorization:"Bearer ".concat(F)}});if(e.data.msg){k("Product deleted successfully!");try{t.push("/admin/products/manage")}catch(e){console.error("Navigation error:",e),window.location.href="/admin/products"}}else throw Error(e.data.msg||"Failed to delete product")}catch(e){_(e.message||"An error occurred while deleting the product"),console.error("Delete product error:",e)}finally{C(!1),M(!1)}};return j?(0,o.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{height:"300px"},children:(0,o.jsx)(n.A,{animation:"border",role:"status",children:(0,o.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(i.A,{className:"mb-4",children:[(0,o.jsx)(i.A.Header,{className:"bg-primary text-white",children:(0,o.jsx)("h5",{className:"mb-0",children:"Manage Product Photo & Settings"})}),(0,o.jsxs)(i.A.Body,{children:[T&&(0,o.jsx)(l.A,{variant:"danger",children:T}),S&&(0,o.jsx)(l.A,{variant:"success",children:S}),(0,o.jsxs)("div",{className:"row",children:[(0,o.jsxs)("div",{className:"col-md-6",children:[(0,o.jsx)("h6",{className:"mb-3",children:"Current Product Photo"}),(0,o.jsx)("div",{className:"border rounded p-2 mb-3",style:{height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:r.photo?(0,o.jsx)("img",{src:r.photo,alt:r.name,style:{maxHeight:"230px",maxWidth:"100%",objectFit:"contain"}}):(0,o.jsx)("div",{className:"text-center text-muted",children:"No photo available"})})]}),(0,o.jsxs)("div",{className:"col-md-6",children:[(0,o.jsx)("h6",{className:"mb-3",children:"Update Product Photo"}),(0,o.jsx)("div",{className:"border rounded p-2 mb-3",style:{height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:w?(0,o.jsx)("img",{src:w,alt:"Preview",style:{maxHeight:"230px",maxWidth:"100%",objectFit:"contain"}}):(0,o.jsx)("div",{className:"text-center text-muted",children:"New photo preview"})})]})]}),(0,o.jsxs)("div",{className:"mt-4",children:[(0,o.jsxs)(d.A.Group,{controlId:"productPhoto",className:"mb-3",children:[(0,o.jsx)(d.A.Label,{children:"Choose New Photo"}),(0,o.jsx)(d.A.Control,{type:"file",onChange:e=>{let t=e.target.files[0];t&&(b(t),E(URL.createObjectURL(t)))},accept:"image/*"}),(0,o.jsx)(d.A.Text,{className:"text-muted",children:"Recommended size: 800x800 pixels, max file size: 2MB"})]}),(0,o.jsx)(h.A,{variant:"success",onClick:G,disabled:!f||v,className:"me-2",children:v?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.A,{animation:"border",size:"sm",className:"me-2"}),"Updating..."]}):"Update Photo"})]}),(0,o.jsx)("hr",{className:"my-4"}),(0,o.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("h6",{className:"mb-0",children:["Product: ",r.name]}),(0,o.jsxs)("small",{className:"text-muted",children:["ID: ",r._id]})]}),(0,o.jsx)(h.A,{variant:"danger",onClick:()=>M(!0),children:"Delete Product"})]})]})]}),(0,o.jsxs)(u.A,{show:P,onHide:()=>M(!1),children:[(0,o.jsx)(u.A.Header,{closeButton:!0,children:(0,o.jsx)(u.A.Title,{children:"Confirm Delete"})}),(0,o.jsxs)(u.A.Body,{children:["Are you sure you want to delete ",(0,o.jsx)("strong",{children:r.name}),"? This action cannot be undone."]}),(0,o.jsxs)(u.A.Footer,{children:[(0,o.jsx)(h.A,{variant:"secondary",onClick:()=>M(!1),children:"Cancel"}),(0,o.jsx)(h.A,{variant:"danger",onClick:B,disabled:A,children:A?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.A,{animation:"border",size:"sm",className:"me-2"}),"Deleting..."]}):"Delete Product"})]})]})]})}},5679:(e,t,r)=>{Promise.resolve().then(r.bind(r,5524))},6736:(e,t,r)=>{"use strict";r.d(t,{Fs:()=>c,Jy:()=>n,QT:()=>i,bW:()=>a,d$:()=>s,o7:()=>d,oo:()=>h,p7:()=>l});var o=r(668);async function a(){try{let e=await fetch("".concat(o.M,"/public/all_categories"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Server Error ");return await e.json()}catch(e){console.log("Error fetching categories:",e)}}async function c(){try{let e=await fetch("".concat(o.M,"/public/all_brands"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Server Error ");return await e.json()}catch(e){console.log("Error fetching brands:",e)}}async function s(){try{let e=await fetch("".concat(o.M,"/public/all_products"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Server Error ");return await e.json()}catch(e){console.log("Error fetching products:",e)}}async function n(e){try{let t=await fetch("".concat(o.M,"/public/products_by_category/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Server Error ");return await t.json()}catch(e){console.log("Error fetching products:",e)}}async function i(e){try{let t=await fetch("".concat(o.M,"/public/products_by_brand/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Server Error ");return await t.json()}catch(e){console.log("Error fetching products:",e)}}async function l(e){try{let t=await fetch("".concat(o.M,"/public/category/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Server Error ");return await t.json()}catch(e){console.log("Error fetching products:",e)}}async function d(e){try{let t=await fetch("".concat(o.M,"/public/brand_single/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Server Error ");return await t.json()}catch(e){console.log("Error fetching products:",e)}}async function h(e){try{let t=await fetch("".concat(o.M,"/public/product_single/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Server Error ");return await t.json()}catch(e){console.log("Error fetching product:",e)}}}},e=>{var t=t=>e(e.s=t);e.O(0,[3464,6918,8996,3865,8441,1684,7358],()=>t(5679)),_N_E=e.O()}]);