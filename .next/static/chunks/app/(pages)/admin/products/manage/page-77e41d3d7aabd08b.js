(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2499],{668:(e,a,t)=>{"use strict";t.d(a,{M:()=>s});let s="http://localhost:5200"},2904:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>_});var s=t(5155),c=t(6736),r=t(2115),n=t(2809),l=t(1846),o=t(8136),i=t(4016),d=t(8964),m=t(902),h=t(3045),u=t(8293),p=t(7924),x=t(3904),j=t(6932),b=t(3332),g=t(235),N=t(8050),y=t(3717),f=t(668),v=t(4553),w=t(3464),k=t(6874),S=t.n(k);function _(){let e=(0,v.b)(),[a,t]=(0,r.useState)([]),[k,_]=(0,r.useState)([]),[A,C]=(0,r.useState)([]),[E,F]=(0,r.useState)([]),[M,T]=(0,r.useState)(""),[P,I]=(0,r.useState)(!0),[z,L]=(0,r.useState)(""),[B,G]=(0,r.useState)(""),[Q,U]=(0,r.useState)(1),[q]=(0,r.useState)(6),[D,O]=(0,r.useState)({name:"",price:"",stockQuantity:0,description:"",category:"",brand:"",inStock:!1,isFeatured:!1}),[W,K]=(0,r.useState)(!1),[$,J]=(0,r.useState)(""),[R,Z]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{I(!0);let e=await (0,c.d$)(),a=await (0,c.bW)(),s=await (0,c.Fs)();e&&(t(e.products),_(e.products),C(a.categories),F(s.brands))}catch(e){console.log("Error fetching products:",e)}finally{I(!1)}})()},[]),(0,r.useEffect)(()=>{"undefined"!=typeof document&&document.querySelectorAll(".modal").forEach(e=>{bootstrap.Modal.getInstance(e)||new bootstrap.Modal(e)})},[]);let H=e=>{let a=E.find(a=>a._id===e);return a?a.brandName:"Unknown Brand"},V=e=>{let a=A.find(a=>a._id===e);return a?a.catName:"Unknown Category"},X=(e,t,s)=>{let c=[...a];e&&(c=c.filter(a=>a.name.toLowerCase().includes(e.toLowerCase())||a.description.toLowerCase().includes(e.toLowerCase()))),t&&(c=c.filter(e=>e.brand===t)),s&&(c=c.filter(e=>e.category===s)),_(c),U(1)},Y=()=>{T(""),L(""),G(""),_(a),U(1)},ee=Q*q,ea=ee-q,et=k.slice(ea,ee),es=Math.ceil(k.length/q),ec=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"MWK"}).format(e),er=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),en=e=>{let{name:a,value:t}=e.target;O(e=>({...e,[a]:t}))},el=e=>{let{name:a,checked:t}=e.target;O(e=>({...e,[a]:t}))},eo=e=>{Z(e._id),O({name:e.name||"",price:e.price||"",stockQuantity:e.stockQuantity||0,description:e.description||"",category:e.category||"",brand:e.brand||"",inStock:e.inStock||!1,isFeatured:e.isFeatured||!1}),J("")},ei=async s=>{K(!0),J("");try{if(!R)throw Error("Product ID is missing");let c={...D,productId:R},r=await w.A.put("".concat(f.M,"/admin/update_product/").concat(s),c,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(r.data.success){let e=a.map(e=>e._id===R?{...e,...D}:e);t(e),_(k.map(e=>e._id===R?{...e,...D}:e)),alert("Product updated successfully!");{let e=document.querySelector("#productModal-".concat(R)),a=bootstrap.Modal.getInstance(e);a&&a.hide()}}else throw Error(r.data.msg||"Failed to update product")}catch(e){J(e.message||"An error occurred while updating the product"),console.error("Update error:",e)}finally{K(!1)}};return(0,s.jsxs)(n.A,{fluid:!0,className:"py-5 px-4",children:[(0,s.jsx)(l.A,{className:"mb-4",children:(0,s.jsxs)(o.A,{children:[(0,s.jsxs)("h2",{className:"fw-bold d-flex align-items-center",children:[(0,s.jsx)(u.A,{className:"me-2",size:28}),"Product Catalogue"]}),(0,s.jsx)("p",{className:"text-muted",children:"Manage your product inventory"})]})}),(0,s.jsx)(i.A,{className:"mb-4 border-0 shadow-sm",children:(0,s.jsx)(i.A.Body,{children:(0,s.jsxs)(l.A,{className:"g-3",children:[(0,s.jsx)(o.A,{lg:4,md:6,children:(0,s.jsxs)("div",{className:"position-relative",children:[(0,s.jsx)(d.A.Control,{type:"text",placeholder:"Search products...",value:M,onChange:e=>{T(e.target.value),X(e.target.value,z,B)},className:"ps-4 py-2"}),(0,s.jsx)(p.A,{size:18,className:"position-absolute text-muted",style:{left:"10px",top:"12px"}})]})}),(0,s.jsx)(o.A,{lg:3,md:6,children:(0,s.jsxs)(d.A.Select,{value:z,onChange:e=>{L(e.target.value),X(M,e.target.value,B)},className:"py-2",children:[(0,s.jsx)("option",{value:"",children:"All Brands"}),E.map(e=>(0,s.jsx)("option",{value:e._id,children:e.brandName},e._id))]})}),(0,s.jsx)(o.A,{lg:3,md:6,children:(0,s.jsxs)(d.A.Select,{value:B,onChange:e=>{G(e.target.value),X(M,z,e.target.value)},className:"py-2",children:[(0,s.jsx)("option",{value:"",children:"All Categories"}),A.map(e=>(0,s.jsx)("option",{value:e._id,children:e.catName},e._id))]})}),(0,s.jsx)(o.A,{lg:2,md:6,className:"d-flex justify-content-end",children:(0,s.jsxs)(m.A,{variant:"outline-secondary",onClick:Y,className:"d-flex align-items-center",children:[(0,s.jsx)(x.A,{size:16,className:"me-1"}),"Reset"]})})]})})}),P?(0,s.jsxs)("div",{className:"text-center py-5",children:[(0,s.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,s.jsx)("p",{className:"mt-2",children:"Loading products..."})]}):0===k.length?(0,s.jsxs)("div",{className:"text-center py-5",children:[(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsx)(j.A,{size:48,className:"text-muted"})}),(0,s.jsx)("h4",{children:"No products found"}),(0,s.jsx)("p",{className:"text-muted",children:"Try adjusting your search or filter criteria"}),(0,s.jsx)(m.A,{variant:"primary",onClick:Y,children:"Clear Filters"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"mb-0",children:["Showing ",ea+1,"-",Math.min(ee,k.length)," of ",k.length," products"]})}),(0,s.jsx)("div",{children:(0,s.jsxs)(d.A.Select,{className:"d-inline-block w-auto",children:[(0,s.jsx)("option",{children:"Sort by newest"}),(0,s.jsx)("option",{children:"Sort by price: low to high"}),(0,s.jsx)("option",{children:"Sort by price: high to low"}),(0,s.jsx)("option",{children:"Sort by name: A-Z"})]})})]}),(0,s.jsx)(l.A,{xs:1,md:2,lg:3,className:"g-4 mb-4",children:et.map(e=>{var a;return(0,s.jsx)(o.A,{children:(0,s.jsxs)(i.A,{className:"h-100 border-0 shadow-sm",children:[(0,s.jsxs)("div",{className:"position-relative",children:[(0,s.jsx)(i.A.Img,{variant:"top",src:e.photo,alt:e.name,style:{height:"220px",objectFit:"cover",objectPosition:"center"}}),e.isFeatured&&(0,s.jsx)("span",{className:"position-absolute top-0 end-0 bg-warning text-dark m-2 px-2 py-1 rounded-pill small fw-bold",children:"Featured"}),!e.inStock&&(0,s.jsx)("span",{className:"position-absolute top-0 start-0 bg-danger text-white m-2 px-2 py-1 rounded-pill small fw-bold",children:"Out of Stock"})]}),(0,s.jsxs)(i.A.Body,{children:[(0,s.jsxs)("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[(0,s.jsx)(i.A.Title,{className:"h5 mb-0",children:e.name}),(0,s.jsx)("span",{className:"fw-bold text-primary",children:ec(e.price)})]}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsxs)("span",{className:"badge bg-light text-dark me-2",children:[(0,s.jsx)(b.A,{size:14,className:"me-1"}),V(e.category)]}),(0,s.jsxs)("span",{className:"badge bg-light text-dark",children:[(0,s.jsx)(g.A,{size:14,className:"me-1"}),H(e.brand)]})]}),(0,s.jsx)(i.A.Text,{className:"small text-muted",children:(0,s.jsxs)("span",{className:"fw-bold text-primary",children:[(0,s.jsx)(N.A,{size:14,className:"me-1"}),"quantity ",e.stockQuantity]})}),(0,s.jsx)(i.A.Text,{className:"small text-muted",children:e.description.length>100?"".concat(e.description.substring(0,100),"..."):e.description}),(0,s.jsxs)("div",{className:"small text-muted mb-3",children:["Added: ",er(e.createdAt)]})]}),(0,s.jsxs)(i.A.Footer,{className:"bg-white border-top-0 text-center",children:[(0,s.jsx)("div",{className:"d-flex align-items-center",children:(0,s.jsxs)(m.A,{variant:"outline-primary",size:"sm",className:"d-flex align-items-center","data-bs-toggle":"modal","data-bs-target":"#productModal-".concat(e._id),onClick:()=>eo(e),children:[(0,s.jsx)(y.A,{size:14,className:"me-1"}),"Manage"]})}),(0,s.jsx)("div",{className:"modal fade",id:"productModal-".concat(e._id),tabIndex:"-1","aria-labelledby":"productModalLabel-".concat(e._id),"aria-hidden":"true",children:(0,s.jsx)("div",{className:"modal-dialog modal-lg",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h5",{className:"modal-title",id:"productModalLabel-".concat(e._id),children:e.name}),(0,s.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),(0,s.jsx)("div",{className:"modal-body",children:(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-md-6 mb-3 mb-md-0",children:(0,s.jsx)("img",{src:e.photo,alt:e.name,className:"img-fluid rounded"})}),(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h4",{className:"fw-bold",children:ec(e.price)}),(0,s.jsx)("span",{className:"badge ".concat(e.inStock?"bg-success":"bg-danger"," mb-2"),children:e.inStock?"In Stock":"Out of Stock"}),(0,s.jsxs)("p",{className:"text-muted small",children:["Category: ",(null===(a=A.find(a=>a._id===e.category))||void 0===a?void 0:a.catName)||"Unknown"]}),(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"text-muted small",children:[" ",(0,s.jsx)(S(),{href:"/admin/products/manage/".concat(e._id),children:"click here for more features"})," "]})})]}),(0,s.jsx)("hr",{}),(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsxs)("form",{className:"row g-3",onSubmit:()=>ei(e._id),children:[$&&(0,s.jsx)("div",{className:"col-12",children:(0,s.jsx)("div",{className:"alert alert-danger",role:"alert",children:$})}),(0,s.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,s.jsx)("label",{htmlFor:"productName-".concat(e._id),className:"form-label",children:"Product Name"}),(0,s.jsx)("input",{type:"text",className:"form-control",id:"productName-".concat(e._id),name:"name",value:D.name,onChange:en,required:!0})]}),(0,s.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,s.jsx)("label",{htmlFor:"productPrice-".concat(e._id),className:"form-label",children:"Price"}),(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("span",{className:"input-group-text",children:"MWK"}),(0,s.jsx)("input",{type:"number",className:"form-control",id:"productPrice-".concat(e._id),name:"price",value:D.price,onChange:en,required:!0})]})]}),(0,s.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,s.jsx)("label",{htmlFor:"productStock-".concat(e._id),className:"form-label",children:"Stock Quantity"}),(0,s.jsx)("input",{type:"number",className:"form-control",id:"productStock-".concat(e._id),name:"stockQuantity",value:D.stockQuantity,onChange:en})]}),(0,s.jsxs)("div",{className:"col-12 mb-3",children:[(0,s.jsx)("label",{htmlFor:"productDescription-".concat(e._id),className:"form-label",children:"Description"}),(0,s.jsx)("textarea",{className:"form-control",id:"productDescription-".concat(e._id),rows:"4",name:"description",value:D.description,onChange:en})]}),(0,s.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,s.jsx)("label",{htmlFor:"productCategory-".concat(e._id),className:"form-label",children:"Categories"}),(0,s.jsxs)("select",{className:"form-select",id:"productCategory-".concat(e._id),name:"category",value:D.category,onChange:en,required:!0,children:[(0,s.jsx)("option",{value:"",children:"Choose Category"}),null==A?void 0:A.map(e=>(0,s.jsx)("option",{value:e._id,children:e.catName},e._id))]})]}),(0,s.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,s.jsx)("label",{htmlFor:"productBrand-".concat(e._id),className:"form-label",children:"Brand"}),(0,s.jsxs)("select",{className:"form-select",id:"productBrand-".concat(e._id),name:"brand",value:D.brand,onChange:en,required:!0,children:[(0,s.jsx)("option",{value:"",children:"Choose Brand"}),null==E?void 0:E.map(e=>(0,s.jsx)("option",{value:e._id,children:e.brandName},e._id))]})]}),(0,s.jsx)("div",{className:"col-md-6 mb-3",children:(0,s.jsxs)("div",{className:"form-check form-switch",children:[(0,s.jsx)("input",{className:"form-check-input",type:"checkbox",id:"inStockToggle-".concat(e._id),name:"inStock",checked:D.inStock,onChange:el}),(0,s.jsx)("label",{className:"form-check-label",htmlFor:"inStockToggle-".concat(e._id),children:"In Stock"})]})}),(0,s.jsx)("div",{className:"col-md-6 mb-3",children:(0,s.jsxs)("div",{className:"form-check form-switch",children:[(0,s.jsx)("input",{className:"form-check-input",type:"checkbox",id:"isFeaturedToggle-".concat(e._id),name:"isFeatured",checked:D.isFeatured,onChange:el}),(0,s.jsx)("label",{className:"form-check-label",htmlFor:"isFeaturedToggle-".concat(e._id),children:"Featured Product"})]})}),(0,s.jsx)("div",{className:"col-12 mt-4",children:(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:W,children:W?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating..."]}):"Update Product"})})]})})]})]})}),(0,s.jsx)("div",{className:"modal-footer",children:(0,s.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})})]})})})]})]})},e._id)})}),es>1&&(0,s.jsx)("div",{className:"d-flex justify-content-center",children:(0,s.jsxs)(h.A,{children:[(0,s.jsx)(h.A.First,{onClick:()=>U(1),disabled:1===Q}),(0,s.jsx)(h.A.Prev,{onClick:()=>U(e=>Math.max(e-1,1)),disabled:1===Q}),Array.from({length:Math.min(5,es)},(e,a)=>{let t;return t=es<=5?a+1:Q<=3?a+1:Q>=es-2?es-4+a:Q-2+a,(0,s.jsx)(h.A.Item,{active:t===Q,onClick:()=>U(t),children:t},t)}),(0,s.jsx)(h.A.Next,{onClick:()=>U(e=>Math.min(e+1,es)),disabled:Q===es}),(0,s.jsx)(h.A.Last,{onClick:()=>U(es),disabled:Q===es})]})})]})]})}},4553:(e,a,t)=>{"use strict";t.d(a,{b:()=>s});let s=()=>localStorage.getItem("usertoken")},5416:(e,a,t)=>{Promise.resolve().then(t.bind(t,2904))},6736:(e,a,t)=>{"use strict";t.d(a,{Fs:()=>r,Jy:()=>l,QT:()=>o,bW:()=>c,d$:()=>n,o7:()=>d,oo:()=>m,p7:()=>i});var s=t(668);async function c(){try{let e=await fetch("".concat(s.M,"/public/all_categories"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Server Error ");return await e.json()}catch(e){console.log("Error fetching categories:",e)}}async function r(){try{let e=await fetch("".concat(s.M,"/public/all_brands"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Server Error ");return await e.json()}catch(e){console.log("Error fetching brands:",e)}}async function n(){try{let e=await fetch("".concat(s.M,"/public/all_products"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Server Error ");return await e.json()}catch(e){console.log("Error fetching products:",e)}}async function l(e){try{let a=await fetch("".concat(s.M,"/public/products_by_category/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)throw Error("Server Error ");return await a.json()}catch(e){console.log("Error fetching products:",e)}}async function o(e){try{let a=await fetch("".concat(s.M,"/public/products_by_brand/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)throw Error("Server Error ");return await a.json()}catch(e){console.log("Error fetching products:",e)}}async function i(e){try{let a=await fetch("".concat(s.M,"/public/category/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)throw Error("Server Error ");return await a.json()}catch(e){console.log("Error fetching products:",e)}}async function d(e){try{let a=await fetch("".concat(s.M,"/public/brand_single/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)throw Error("Server Error ");return await a.json()}catch(e){console.log("Error fetching products:",e)}}async function m(e){try{let a=await fetch("".concat(s.M,"/public/product_single/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)throw Error("Server Error ");return await a.json()}catch(e){console.log("Error fetching product:",e)}}}},e=>{var a=a=>e(e.s=a);e.O(0,[6874,3464,6918,9156,8441,1684,7358],()=>a(5416)),_N_E=e.O()}]);