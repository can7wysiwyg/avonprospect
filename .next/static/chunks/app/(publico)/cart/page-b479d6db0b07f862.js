(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5167],{668:(e,s,a)=>{"use strict";a.d(s,{M:()=>c});let c="http://localhost:5200"},4553:(e,s,a)=>{"use strict";a.d(s,{b:()=>c});let c=()=>localStorage.getItem("usertoken")},7406:(e,s,a)=>{Promise.resolve().then(a.bind(a,7846))},7846:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>p});var c=a(5155),l=a(9137),t=a.n(l),d=a(2115),i=a(6151),r=a(7550),n=a(7712),m=a(4616),o=a(2525),x=a(6874),b=a.n(x),j=a(8631),h=a(3464),u=a(668),N=a(4553);function p(e){let{cartItems:s}=e,[a,l]=(0,d.useState)([]),[x,p]=(0,d.useState)("cart"),[v,g]=(0,d.useState)({fullname:"",email:"",phonenumber:"",address:""}),[f,y]=(0,d.useState)(!1),[k,w]=(0,d.useState)({}),S=(0,N.b)();(0,d.useEffect)(()=>{l((0,j.Xl)().map(e=>({...e,quantity:1})))},[]);let q=a.reduce((e,s)=>e+s.price*s.quantity,0),C=q>100?0:15,_=q+C,I=(e,s)=>{if(s<1)return;let c=a.find(s=>s._id===e);if(s>c.stockQuantity){alert("Sorry, only ".concat(c.stockQuantity," items are available in stock."));return}l(a.map(a=>a._id===e?{...a,quantity:s}:a))},A=e=>{let s=a.filter(s=>s._id!==e);(0,j.SM)(e),window.location.reload(),l(s)},O=e=>{let{name:s,value:a}=e.target;g({...v,[s]:a}),k[s]&&w({...k,[s]:""})},M=()=>{let e={};return v.fullname.trim()||(e.fullname="Full name is required"),v.email.trim()?/^\S+@\S+\.\S+$/.test(v.email)||(e.email="Email is invalid"):e.email="Email is required",v.phonenumber.trim()||(e.phonenumber="Phone number is required"),v.address.trim()||(e.address="Address is required"),w(e),0===Object.keys(e).length},z=async e=>{if(e.preventDefault(),M()){y(!0);try{let e={...v,cartContents:a.map(e=>({product:e._id,quantity:e.quantity})),amount:_},s=await h.A.post("".concat(u.M,"/shopper/add_to_cart"),e,{headers:{Authorization:"Bearer ".concat(S)}});s.data.msg&&(alert(s.data.msg),l([]),(0,j.Ed)(),window.location.reload(),g({fullname:"",email:"",phonenumber:"",address:""})),p("cart")}catch(e){console.error("Error submitting order:",e),alert("There was an error placing your order. Please try again.")}finally{y(!1)}}};return 0===a.length?(0,c.jsx)("div",{className:"container py-5",children:(0,c.jsxs)("div",{className:"empty-cart text-center py-5",children:[(0,c.jsx)("div",{className:"empty-cart-icon mb-4",children:(0,c.jsx)(i.A,{size:80,color:"#ccc"})}),(0,c.jsx)("h2",{className:"mb-3",children:"Your cart is empty"}),(0,c.jsx)("p",{className:"text-muted mb-4",children:"Looks like you have not added any items to your cart yet."}),(0,c.jsx)(b(),{href:"/products",className:"btn btn-primary btn-lg",children:"Continue Shopping"})]})}):(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 shopping-cart",children:[(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 container py-5",children:[(0,c.jsx)("h1",{className:"jsx-93535375d2b13c25 mb-4 fw-bold",children:"cart"===x?"Shopping Cart":"Checkout"}),"checkout"===x&&(0,c.jsxs)("button",{onClick:()=>p("cart"),className:"jsx-93535375d2b13c25 btn btn-link text-decoration-none mb-3 ps-0",children:[(0,c.jsx)(r.A,{size:18,className:"me-1"})," Back to cart"]}),(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 row g-4",children:[(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 col-lg-8",children:"cart"===x?(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 card shadow-sm",children:[(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 card-header bg-white py-3",children:(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 row align-items-center",children:[(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 col-6",children:(0,c.jsx)("h5",{className:"jsx-93535375d2b13c25 mb-0",children:"Product"})}),(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 col-2 text-center d-none d-md-block",children:(0,c.jsx)("h5",{className:"jsx-93535375d2b13c25 mb-0",children:"Price"})}),(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 col-2 text-center",children:(0,c.jsx)("h5",{className:"jsx-93535375d2b13c25 mb-0",children:"Quantity"})}),(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 col-2 text-end",children:(0,c.jsx)("h5",{className:"jsx-93535375d2b13c25 mb-0",children:"Total"})})]})}),(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 card-body p-0",children:a.map(e=>(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 cart-item border-bottom p-3",children:(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 row align-items-center",children:[(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 col-md-6 col-12 mb-3 mb-md-0",children:(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 d-flex align-items-center",children:[(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 cart-item-image me-3",children:(0,c.jsx)("img",{src:e.photo,alt:e.name,style:{maxWidth:"80px",maxHeight:"80px",objectFit:"cover"},className:"jsx-93535375d2b13c25 img-fluid rounded"})}),(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 cart-item-details",children:[(0,c.jsx)("h6",{className:"jsx-93535375d2b13c25 mb-1",children:e.name}),(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 text-muted small d-md-none",children:["MWK",e.price]})]})]})}),(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 col-md-2 col-12 text-center d-none d-md-block",children:(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 fw-bold",children:["MWK",e.price]})}),(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 col-md-2 col-6 text-center",children:[(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 quantity-control d-flex align-items-center justify-content-center",children:[(0,c.jsx)("button",{onClick:()=>I(e._id,e.quantity-1),"aria-label":"Decrease quantity",className:"jsx-93535375d2b13c25 btn btn-sm btn-outline-secondary border-0",children:(0,c.jsx)(n.A,{size:16})}),(0,c.jsx)("span",{className:"jsx-93535375d2b13c25",children:Math.max(1,Math.min(e.quantity,e.stockQuantity))}),(0,c.jsx)("button",{onClick:()=>I(e._id,e.quantity+1),"aria-label":"Increase quantity",className:"jsx-93535375d2b13c25 btn btn-sm btn-outline-secondary border-0",children:(0,c.jsx)(m.A,{size:16})})]}),(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 mt-1 small text-muted",children:e.stockQuantity>0?"".concat(e.stockQuantity," available"):"Out of stock"})]}),(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 col-md-2 col-6 text-end",children:[(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 fw-bold mb-2",children:["MWK",e.price*e.quantity]}),(0,c.jsxs)("button",{onClick:()=>A(e._id),"aria-label":"Remove item",className:"jsx-93535375d2b13c25 btn btn-sm text-danger p-0",children:[(0,c.jsx)(o.A,{size:16,className:"me-1"})," Remove"]})]})]})},e._id))}),(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 card-footer bg-white py-3",children:(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 d-flex justify-content-between align-items-center",children:[(0,c.jsxs)(b(),{href:"/products",className:"btn btn-outline-secondary",children:[(0,c.jsx)(r.A,{size:18,className:"me-1"})," Continue Shopping"]}),(0,c.jsxs)("button",{onClick:()=>p("checkout"),className:"jsx-93535375d2b13c25 btn btn-primary",children:["Proceed to Checkout ",(0,c.jsx)(r.A,{size:18,className:"ms-1",style:{transform:"rotate(180deg)"}})]})]})})]}):(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 card shadow-sm",children:[(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 card-header bg-white py-3",children:(0,c.jsx)("h5",{className:"jsx-93535375d2b13c25 mb-0",children:"Shipping Information"})}),(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 card-body",children:(0,c.jsxs)("form",{onSubmit:z,className:"jsx-93535375d2b13c25",children:[(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 row g-3",children:[(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 col-12",children:[(0,c.jsx)("label",{htmlFor:"fullname",className:"jsx-93535375d2b13c25 form-label",children:"Full Name *"}),(0,c.jsx)("input",{type:"text",id:"fullname",name:"fullname",value:v.fullname,onChange:O,placeholder:"Enter your full name",required:!0,className:"jsx-93535375d2b13c25 "+"form-control ".concat(k.fullname?"is-invalid":"")}),k.fullname&&(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 invalid-feedback",children:k.fullname})]}),(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 col-md-6",children:[(0,c.jsx)("label",{htmlFor:"email",className:"jsx-93535375d2b13c25 form-label",children:"Email Address *"}),(0,c.jsx)("input",{type:"email",id:"email",name:"email",value:v.email,onChange:O,placeholder:"you@example.com",required:!0,className:"jsx-93535375d2b13c25 "+"form-control ".concat(k.email?"is-invalid":"")}),k.email&&(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 invalid-feedback",children:k.email})]}),(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 col-md-6",children:[(0,c.jsx)("label",{htmlFor:"phonenumber",className:"jsx-93535375d2b13c25 form-label",children:"Phone Number *"}),(0,c.jsx)("input",{type:"tel",id:"phonenumber",name:"phonenumber",value:v.phonenumber,onChange:O,placeholder:"+265 88 456 890",required:!0,className:"jsx-93535375d2b13c25 "+"form-control ".concat(k.phonenumber?"is-invalid":"")}),k.phonenumber&&(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 invalid-feedback",children:k.phonenumber})]}),(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 col-12",children:[(0,c.jsx)("label",{htmlFor:"address",className:"jsx-93535375d2b13c25 form-label",children:"Full Address *"}),(0,c.jsx)("textarea",{id:"address",name:"address",rows:"3",value:v.address,onChange:O,placeholder:"Your address",required:!0,className:"jsx-93535375d2b13c25 "+"form-control ".concat(k.address?"is-invalid":"")}),k.address&&(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 invalid-feedback",children:k.address})]})]}),(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 d-grid mt-4",children:(0,c.jsx)("button",{type:"submit",disabled:f,className:"jsx-93535375d2b13c25 btn btn-primary btn-lg",children:f?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{role:"status","aria-hidden":"true",className:"jsx-93535375d2b13c25 spinner-border spinner-border-sm me-2"}),"Processing Order..."]}):(0,c.jsx)(c.Fragment,{children:"Place Order"})})})]})})]})}),(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 col-lg-4",children:(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 card shadow-sm",children:[(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 card-header bg-white py-3",children:(0,c.jsx)("h5",{className:"jsx-93535375d2b13c25 mb-0",children:"Order Summary"})}),(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 card-body",children:[(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 d-flex justify-content-between mb-2",children:[(0,c.jsx)("span",{className:"jsx-93535375d2b13c25",children:"Subtotal"}),(0,c.jsxs)("span",{className:"jsx-93535375d2b13c25 fw-bold",children:["MWK",q]})]}),(0,c.jsx)("hr",{className:"jsx-93535375d2b13c25"}),(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 d-flex justify-content-between mb-2",children:[(0,c.jsx)("span",{className:"jsx-93535375d2b13c25 fw-bold",children:"Total"}),(0,c.jsxs)("span",{className:"jsx-93535375d2b13c25 fw-bold fs-5",children:["MWK",_]})]}),"cart"===x&&(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 d-grid mt-3",children:(0,c.jsx)("button",{onClick:()=>p("checkout"),className:"jsx-93535375d2b13c25 btn btn-primary btn-lg",children:"Checkout"})}),"checkout"===x&&(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 mt-3",children:[(0,c.jsxs)("h6",{className:"jsx-93535375d2b13c25 mb-3",children:["Cart Items (",a.length,")"]}),(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 summary-items",children:a.map(e=>(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 d-flex justify-content-between align-items-center mb-2",children:[(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 d-flex align-items-center",children:[(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 small-image me-2",children:(0,c.jsx)("img",{src:e.photo,alt:e.name,style:{width:"40px",height:"40px",objectFit:"cover"},className:"jsx-93535375d2b13c25 img-fluid rounded"})}),(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25",children:[(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 small fw-bold",children:e.name}),(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 text-muted small",children:["Qty: ",e.quantity]})]})]}),(0,c.jsx)("div",{className:"jsx-93535375d2b13c25 text-end",children:(0,c.jsxs)("div",{className:"jsx-93535375d2b13c25 fw-bold",children:["MWK",e.price*e.quantity]})})]},e._id))})]})]})]})})]})]}),(0,c.jsx)(t(),{id:"93535375d2b13c25",children:".cart-item{-webkit-transition:background-color.2s;-moz-transition:background-color.2s;-o-transition:background-color.2s;transition:background-color.2s}.cart-item:hover{background-color:#f8f9fa}.quantity-input::-webkit-inner-spin-button,.quantity-input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.quantity-input{-moz-appearance:textfield}.summary-items{max-height:300px;overflow-y:auto}.form-control:focus,.btn:focus{-webkit-box-shadow:0 0 0 .25rem rgba(13,110,253,.25);-moz-box-shadow:0 0 0 .25rem rgba(13,110,253,.25);box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}@media(max-width:768px){.cart-item{padding:15px 10px}}"})]})}},8631:(e,s,a)=>{"use strict";a.d(s,{B5:()=>c,Ed:()=>i,SM:()=>d,Xl:()=>t,Yr:()=>l});let c=(e,s)=>{let a=[];localStorage.getItem("cart")&&(a=JSON.parse(localStorage.getItem("cart"))),a.push({...e,count:1}),a=Array.from(new Set(a.map(e=>e._id))).map(e=>a.find(s=>s._id===e)),localStorage.setItem("cart",JSON.stringify(a)),s()},l=()=>localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")).length:0,t=()=>localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")):[],d=e=>{let s=[];localStorage.getItem("cart")&&(s=JSON.parse(localStorage.getItem("cart"))),s=s.filter(s=>s._id!==e),localStorage.setItem("cart",JSON.stringify(s))},i=e=>{localStorage.removeItem("cart")}}},e=>{var s=s=>e(e.s=s);e.O(0,[6874,3464,5740,8441,1684,7358],()=>s(7406)),_N_E=e.O()}]);